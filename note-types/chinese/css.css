/* Fonts — add .woff2 files to Anki media folder (prefix _ prevents cleanup) */
@font-face { font-family: 'Inter'; src: url('_inter.woff2') format('woff2'); font-weight: 100 900; }
@font-face { font-family: 'JetBrains Mono'; src: url('_jetbrains-mono.woff2') format('woff2'); font-weight: 400 500; }
@font-face { font-family: 'MOE'; src: url('_moeStandard.ttf'); }
@font-face { font-family: 'Noto Serif TC'; src: url('_notoSerifTC.ttf'); }
@font-face { font-family: 'Source Hans'; src: url('_sourceHans.otf'); }
@font-face { font-family: 'Noto Serif JP'; src: url('_noto-serif-jp.woff2') format('woff2'); font-weight: 400 700; }

:root,
:root[class*=night-mode] {
    /* Override Anki's --canvas so the Qt toolbar matches */
    --canvas: #1a0c0f;

    /* Surface palette — red-tinted darks for depth */
    --bg: #1a0c0f;
    --bg-card: #1c1416;
    --bg-surface: #271e20;
    --bg-surface-hover: #2f2426;

    /* Borders */
    --border: rgba(255, 255, 255, 0.06);
    --border-light: rgba(255, 255, 255, 0.09);

    /* Text — 4-level hierarchy */
    --text-1: rgba(255, 255, 255, 0.92);
    --text-2: rgba(255, 255, 255, 0.56);
    --text-3: rgba(255, 255, 255, 0.30);

    /* Accent — warm crimson */
    --accent: #c85a5a;
    --accent-text: #db7e7e;
    --accent-soft: rgba(200, 90, 90, 0.12);
    --accent-glow: rgba(200, 90, 90, 0.22);

    /* Fonts */
    --mono: 'JetBrains Mono', monospace;
    --sans: 'Inter', -apple-system, system-ui, sans-serif;
    --zh: 'Noto Serif TC', 'MOE', serif;
    --zh-display: 'MOE', 'Noto Serif TC', serif;
    --jp: 'Noto Serif JP', 'Hiragino Mincho ProN', 'Yu Mincho', serif;

    /* Motion */
    --ease: cubic-bezier(0.16, 1, 0.3, 1);
    --spring: cubic-bezier(0.34, 1.56, 0.64, 1);

}

/* — Anki page background —
   html:  covers the Qt widget gap (Desktop) and viewport edge cases
   .card: targets <body> in all Anki clients (Desktop, Mobile, AnkiDroid)
   --canvas override: syncs Anki Desktop's toolbar to our background */

body {
    background-color: #1a0c0f !important;
}

html {
    background:
        url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E") repeat,
        linear-gradient(rgba(20, 5, 8, 0.97), rgba(20, 5, 8, 0.97)),
        url("data:image/png;base64,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") repeat !important;
    background-color: #1a0c0f !important;
    background-size: auto, auto, 204px !important;
    min-height: 100vh;
}

.card {
    background:
        url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E") repeat,
        linear-gradient(rgba(20, 5, 8, 0.97), rgba(20, 5, 8, 0.97)),
        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZgAAAGYCAYAAAB/O/RVAAANPklEQVR42u3d/W8b933A8e+RR1IULUvUk+WH+CFtmjQevBZOlniOLXfB5qEoiv6yIfsX8o+1w4ZgP2TICrRYbCfz3DRx4sFJnGBaE8d2bNl6oihKfLjbLwO2AbUtm4x0JF8vwL+dj3efO+pNfQmfo6tvnkvDDipOFr7cd7763Ha3T9Nw+5tf3TvQq9efO1+9VJgsnNnu9usLjQvLV2rz3bzm3hOVS+PHK9t+zXatffnO20unenXOh/525ssoH2175osXV69t3to6EehrU6+OXRg9Vt72vdtcbF28+5vlsz27796YvRdFYXa729/7l6UbW8vt53vx2nu+P/r76st7Xtru9slWcvXWW/d/3KtzP/CL6Q/z5dzJ7W6/crV2ufZ549Sg3YM5b0MABAYAgQFAYABAYAAQGACGWFw5WvpwJ1+wMB7XQwjPGX12lQ8Ul/OF8KFJ9LdCtZA3hf5Qmi1uJZvJwL3n4slT4yddXsL/+zcE5fnw/bJBwE59qDtYOlc+WAqWyABAYAAQGAAEBgAEBgCBAUBgAEBgABAYAAQGAB4uTlvJ9SwfYKeZrocQDrhUXcyw3rmXL+eaJsGjNFfbqSn0RqvWXs/F8fVhn0P8zT/eP+52GGx3/nnptCnAzln87cq8KVgiA0BgABAYAATGCAAQGAAEBgCBAQCBAUBgABAYABAYAAQGAIEBAIEBQGAAEBgAEBgABAaA4RPv//n0lWE64fxodCzzx1iJjw3bdWHwRFH40775pF2MDnvPfQeBiSu5V4whY2/MXJiLK7k5k4Adq+FUXImmDMISGQACA4DAAIDAACAwAAgMAAgMAAIDgMAAgMAAkF3x8tX13xnDwzXvNg93u4+NrzaPJs3UnOFR77V68kKv9rV5Z+uZ5avBe26XRVffPJcaAwDBEhkAAgOAwACAwAAgMAAIDAAIDAACA4DAAIDAACAwAAgMAAgMAAIDgMAAgMAAIDAADI84ruS+MoaH62ymE2knHe9mH1EcavlSbsk04RHvtY3kQJqGQi/2FeWjen4kum+quxyY/T+fPmIMD7e+0LiwfKU2380+xl6sfDx+vHLGNOHhvn1naaG10n62F/uqfG/kP6onx1411WCJDACBAQCBAUBgABAYABAYAAQGAIEBAIEBQGAAGBhxCKExZOdcDCHkM36MnTQNLbcn/SyKQimEEPXJ4SZpGpquWo8Dc/OX98rDdMJz56uXCpOFTD8XrF1r/+7O20un3J70s0NvzN6LojDbF3XZSj659db9H7tqwRIZAAIDgMAAgMAAIDAACAwACAwAAgOAwACAwAAgMAAIDAAIDAACA4DAAIDAACAwAAgMAHQhnj4zcSHLB9hpdsLyldq8S/X0qif3/mu+EhkEj9T4pjlaX2i8MhAnk0a7esPvPT56pVgtJEMfmPKhYqZ/eKdpuL18pebd34XR75UO5fLRcybBo+SKuUv1hcZgnEyUprv58mM/GM3nRnKvWCIDAIEBQGAAEBgAEBgABAYAgQEAgQFAYAAQGADonXjzTmtHn0WWK0f54kT8mtFnV3u1fblTT1sm0d8KU/mJXCl3YihPfpefRfakknrng9Zq0hi0yxAvvru8o88iK04Wvtx3vurdn2FLn9QrW7e2TphEf5s6Nfbu6NHycJ78Lj+L7EnVbmwkazcaZ4MlMgAQGAAEBgCBAQCBAUBgABAYgODfwSAwAAgMAAIDAAIDgMAAIDAAIDAACAwAAgMAAgOAwADQz+Jn3pipPW6j5X+v3Vj/w+ZLxsWTGpkrfDpzbuIZk9iem79aHDMFulHYk/9q7meTk5kITIiix97QSS6kLhtP9ztylGznHgN6I8mHzLznLJEBIDAACAwAAgMAAgOAwAAgMAAgMAAIDAACAwChp4+KgQxJO+nCt+88GIj7MlfMb+z7q+oLrioZf9et3Hn7wVqv9jZ9euK/CtV4XmDInihqt2vJswMRmEK66oKS+bykUdquJYd7tb9OM1koWCIDwHcwAAgMAAgMAAIDgMAAgMAAIDAACAwAAgMAAgOAwAAgMAAQPK4f4NHSEKKh/a2hE3IhhKXtbh8l6VoIoSowANv5oRlCOqzn3lrvHLn5y3tP8lcmLZEB4DsYALBExkAr7St9Wqjm17e7/dbt5lxrrX3Y5ILvYBAYeJTJlyrL8d749Ha3r43WL618JDDBdzAES2QACAwAAgMAAgOAwAAgMAAgMADBv4MRGAAEBgAEBgCBAUBgAEBgABAYAILH9cMOfuRJp2d/MvFez3ZXiQ8aKlk39kIlHjlQem8QzqU4Fe8XGEI2/x+PaLI0V3zNJBiqz1WjuZOl0aIlMgAQGAAEBgCBAQCBAUBgABAYABAYAAQGAIEBgEeIN77evPC4jVoPWkeMiqfRXmtP17/afL9fjnfzVmvWVaNba19s1IvVwm+GPjAP3l+bdzvwnQVmPZlb+re1OZNgmNSub/i5GiyRASAwAAgMAAJjBAAIDAACA4DAAIDAACAwAAgMAAgMAAIDgMAAgMAAIDAACAwACAwAAgPA8Imf+bvZ9g6/5jFjz7bZs+PHQwhtk+haxQh2R/Skn7RLuR/tws/CwQ/M//yB/ytvBPSz9Oma5GdhsEQGgMAAIDAAIDAACAwAAgMAAgOAwAAgMAAgMABkV3znrftLWT7AJA2jLlN3vv2nxbkQ5VZMoi9MGEH3NhYaf9K4ufmVSexyYNpbyaQxDLZOM4yFkBgEQyPtpKNpJz1iEsESGQACAwACA4DAACAwACAwAAgMAAIDAAIDgMAAIDAAIDAACAwAAgMAAgOAwAAgMADwx8XjJyqXhumE85X8eOaPsZSf2Dtk14XeK84Uy/10vOMvlr9urie3XLkBCsze45UzxpAtUTH64fjxikEwVMpHyufKxhAskQGAwAAgMAAIDAAIDAACA4DAAIDAACAwAAgMAPxxcavWvmwMD9e83+r66RWtlU7FnMm6zW9bUS/317rf/jwaCf9pssMruvrmudQYAAiWyAAQGAAEBgAEBgCBAUBgAEBgABAYAAQGAAQGAIEBQGAAQGAAEBgABAYAuhWXZgufGcPDtWvJVKfRme1uyFEtN5ZfM02yLGmk5Xa9M9mr/ZWm4i9CPuqY7BAHZvb16g+N4eHWFxoXlq/UugrM6POjH48fr5wxTbKsea918e5vl8/2an8zfzk5EUVh1mSDJTIAEBgABAYAgQEAgQFAYAAQGAAQGAAEBgCBAYAeiEOSfj1UZxyFaoiisSwfYpqGepSmD9yedHevR2MhCtW+Od4k3Aoh9eyyQQrMzb9fPDxMJzx3vnqpMFnI9HPBOuvta3feXjrl9qQbU6f2Xhg9OjLfL8d799cPWs2VzlFXLlgiAwCBAUBgABAYABAYAAQGAIEBAIEBQGAAEBgAEBgABAYAgQEAgQFAYAAQGAAQGAAEBoA+Fe/768n3s3yAyWbSXnx3Zd6lenpTp8cvxnvj2CSy7+47D/7cFLpXnC7eqL489sAkdjkwxWp8OssHmKbhtsvUnfLB4v4oHz1nEgxNYCbzy8WJvFgHS2QACAwACAwAAgOAwACAwAAgMAAIDAAIDAACA8DgiOtfNC7u5Avmx/LpyP6iZ4tlWHOx9W5ztZ2YRHeiOAqVoyN/YRJ9IAl/WF9oLBhEjwOz9GHtbNjRZwQVvhzZXzT5DFv7bGOicWvrRybR5fJAIdQqR0cMog90WsnK8gc1HwYskQEgMAAIDAAIDAACA4DAAIDAACAwAAgMAAgMAAIDgMAAgMAAIDAACAwACAwAAgPA8IijOGo8dqtOWkzTkDcunlgUQtRPd04nhDR12ej+o3vk43uID/3NTPlxGz24svbBxsLmy8bFkxrZX7o+Mz9+vF+Ot3ajfnHlo/pZV45uHPzFzAe5UvSyzgKAwAAgMAAIDAAIDAACA4DAAIDAACAwAAgMAAgMABkXGwFZkiThi9v/sDjTq/3t/+nU9fxY7jWTJctWPl5/f/1G48VBOJeZ1yc+Kk0XXhcYQgYfvhzSJK32an9pkuT8ok7m7/skLfbyvt9Naed/33DeeQAE38EAIDAACAwACAwAAgOAwACAwAAgMAAIDAAIDAACA4DAAEDwuH54vPZ60sjvCTe2u31nI0SmBgIDj7V4ceX1J/wrz5saBEtkAAgMAMESGQD9+ltDIVoZP1H5bLvbJ600v3qt/mcCA8Aj5Ufz9/f8YPTUtv9CGi2vXqtbIgPAdzAACAwACAwAAgOAwACAwAAgMAAIDAAIDAACA4DAAIDAACAwAAT/HwzsqigX5uZ+Nnl5ID69RVEUQnjVVSXbb7q0MvfTqd/3aneFsfwxgSGr9hbG4lPGADumWBjPv2SJDADfwQAgMAAgMAAIDAACAwACA4DAACAwACAwAGRdvPbpxnuP22jrXvNZo+JptJZbU2uf139tEtt23gjoRruRTK9er1/KRGBWP1l/zSXhu9JpJHOrV+tzJgE7I20mE2vX6meCJTIAgu9gAEBgABAYAAQGAAQGAIEBQGAAQGAAEBgABst/A2WusTDz+Q+4AAAAAElFTkSuQmCC") repeat !important;
    background-color: #1a0c0f !important;
    background-size: auto, auto, 204px !important;
    margin: 0;
    padding: 40px 20px;
    box-sizing: border-box;
    min-height: 100vh;
}

@media (hover: none) {
    html {
        min-height: 100dvh;
    }

    .card {
        padding: 20px;
        min-height: auto;
    }

    .card-inner {
        min-height: calc(100vh - 40px);
        min-height: calc(100dvh - 40px);
    }

    .front {
        padding-top: calc((100dvh - 120px) * 0.52);
    }
}

/* — Base — */

.card-inner {
    box-sizing: border-box;
    background: rgba(30, 18, 22, 0.67);
    color: var(--text-1);
    font-family: var(--sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    padding: 40px clamp(20px, 6vw, 44px);
    max-width: 580px;
    margin: 0 auto;
    border: 1px solid var(--border);
    border-radius: 16px;
    position: relative;
    overflow: hidden;
    box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.06),
        0 1px 3px rgba(24, 8, 12, 0.40),
        0 4px 12px rgba(24, 8, 12, 0.28),
        0 16px 36px rgba(24, 8, 12, 0.16);
}

@media (hover: none) {
    .card-inner { padding-bottom: 20px; }
}

/* Glass sheen on card surface */
.card-inner::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(300px 250px at 50% 120px, rgba(255, 255, 255, 0.04) 0%, transparent 100%);
    pointer-events: none;
    z-index: 0;
}

/* Grain on card surface */
.card-inner::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    background-size: 180px;
    opacity: 0.035;
    pointer-events: none;
    z-index: 0;
}

/* Card contents above grain */
.card-inner > * {
    position: relative;
    z-index: 1;
}

.divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border-light) 25%, var(--border-light) 75%, transparent);
    margin: 0 0 20px;
}

/* Tone colors */

.tone1 { color: #d94040; }
.tone2 { color: #e89b33; }
.tone3 { color: #2db852; }
.tone4 { color: #3350e8; }
.tone5 { color: #8a8a8a; }

/* — Replay button (targets Anki's generated .replay-button) — */

.replay-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    vertical-align: middle;
    line-height: 1;
}

@media (hover: hover) {
    .replay-button {
        transition: transform 180ms var(--spring);
    }
}

.replay-button svg {
    display: block;
    pointer-events: none;
}

/* Circle */
.replay-button svg circle,
.replay-button .replayCircle {
    fill: var(--bg-surface);
    stroke: rgba(255, 255, 255, 0.07);
    stroke-width: 1.5;
    transition: stroke 200ms ease, fill 200ms ease;
}

/* Triangle — scale down Anki's oversized default path */
.replay-button svg path,
.replay-button .replayTriangle {
    fill: var(--text-2);
    stroke: none;
    transition: fill 200ms ease;
    transform: scale(0.55);
    transform-origin: 32px 32px;
}

@media (hover: hover) {
    .replay-button:hover {
        transform: scale(1.06);
    }

    .replay-button:active {
        transform: scale(0.95);
        transition-duration: 80ms;
    }

    .replay-button:hover svg circle,
    .replay-button:hover .replayCircle {
        fill: var(--bg-surface-hover);
        stroke: var(--accent-glow);
    }

    .replay-button:hover svg path,
    .replay-button:hover .replayTriangle {
        fill: var(--accent);
    }
}

@media (hover: none) {
    .replay-button:active svg circle,
    .replay-button:active .replayCircle {
        fill: var(--bg-surface-hover);
    }
}

/* Playing state — keeps accent colors while [audio:] is playing */
.replay-button.playing svg circle,
.replay-button.playing .replayCircle {
    fill: var(--bg-surface-hover);
    stroke: var(--accent-glow);
}

.replay-button.playing svg path,
.replay-button.playing .replayTriangle {
    fill: var(--accent);
}

/* ================================================
   AUDIO ROW (always visible — front & back)
   ================================================ */

.audio-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: clamp(16px, 8vw, 40px);
}

.audio-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    flex: 1 1 0;
    max-width: 80px;
    min-width: 0;
    overflow: visible;
}

.audio-item .replay-button {
    width: 52px !important;
    height: 52px !important;
    overflow: hidden;
    font-size: 0;
}
.audio-item .replay-button svg,
.audio-item .replay-button img {
    width: 52px !important;
    height: 52px !important;
}

.audio-label {
    font-family: var(--mono);
    font-size: clamp(7px, 2.5vw, 10px);
    font-weight: 500;
    letter-spacing: 0.1em;
    color: var(--text-3);
    text-transform: uppercase;
    white-space: nowrap;
}

/* Front entrance */
.fi {
    animation: fadeIn 0.5s var(--spring) both;
    animation-delay: calc(var(--d, 0) * 1ms);
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(28px) scale(0.94); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes rowSettle {
    from { padding: 48px 0; gap: 40px; }
}

@keyframes btnSettle {
    from { width: 52px; height: 52px; }
}

@keyframes itemSettle {
    from { gap: 10px; }
}

@keyframes labelSettle {
    from { font-size: 10px; }
}

/* ================================================
   FRONT — centered audio with extra padding
   ================================================ */

.front .audio-row {
    padding: 48px 0;
}

@media (hover: none) {
    .front .audio-row {
        padding-bottom: 0;
    }
    .front .audio-item .replay-button {
        width: 68px !important;
        height: 68px !important;
    }
    .front .audio-item .replay-button svg,
    .front .audio-item .replay-button img {
        width: 68px !important;
        height: 68px !important;
    }
}

/* ================================================
   BACK — compact audio controls + answer section
   ================================================ */

.back .audio-row {
    padding: 4px 0 0;
    gap: clamp(8px, 4vw, 20px);
    animation: rowSettle 0.35s var(--ease) both;
}

.back .audio-item {
    gap: 6px;
    animation: itemSettle 0.35s var(--ease) both;
}

.back .audio-item .replay-button {
    width: 40px !important;
    height: 40px !important;
    overflow: hidden;
}
.back .audio-item .replay-button svg,
.back .audio-item .replay-button img {
    width: 40px !important;
    height: 40px !important;
    animation: btnSettle 0.35s var(--ease) both;
}

.back .audio-label {
    font-size: clamp(6.5px, 2.2vw, 9px);
    animation: labelSettle 0.35s var(--ease) both;
}

/* Mobile: skip layout-triggering settle animations (padding, gap, width, height,
   font-size all force reflow every frame — too expensive for mobile WebViews) */
@media (hover: none) {
    .back .audio-row {
        display: none;
    }

    .back > .answer {
        margin-top: -20px;
    }

    .back .audio-row,
    .back .audio-item,
    .back .audio-item .replay-button svg,
    .back .audio-item .replay-button img,
    .back .audio-label {
        animation: none;
    }
}

/* Unwrap {{FrontSide}} containers on back */
.back > .card-inner { display: contents; }
.back > .card-inner::before,
.back > .card-inner::after { display: none; }
.back .front { display: contents; }

/* Hide Anki's auto-injected answer separator */
.back > hr { display: none; }

/* Suppress front entrance animations on back */
.back .fi { animation: none; }

.back .audio-item.bi {
    animation: fadeIn 0.35s var(--spring) 70ms both,
               itemSettle 0.35s var(--ease) both;
}

@media (hover: none) {
    .back .audio-item.bi {
        animation: fadeIn 0.35s var(--spring) 70ms both;
    }
}

.answer {
    display: flex;
    flex-direction: column;
    margin-top: 24px;
    padding-bottom: 8px;
}

@media (hover: none) {
    .answer {
        margin-top: 0;
    }
}

/* Target word — Chinese serif with vertical bopomofo */

.target-word {
    font-family: var(--zh-display);
    font-size: 88px;
    font-weight: normal;
    line-height: 1.2;
    text-align: center;
    margin: 0 0 12px;
    text-rendering: optimizeLegibility;
}

@media (hover: none) {
    .target-word.chars-3 {
        font-size: 64px;
    }
}

/* Ruby (furigana) base styles */

ruby {
    ruby-align: center;
}

rt {
    font-family: var(--zh);
    font-weight: 400;
    color: var(--text-2);
}

.target-word ruby {
    display: inline-flex;
    align-items: center;
}

.target-word ruby > span {
    display: inline-flex;
    align-items: center;
}

.target-word rt {
    display: inline-grid;
    grid-template-columns: auto auto;
    font-size: 18px;
    font-family: var(--zh);
    color: var(--text-1);
    margin-left: 0;
}

.target-word rt .bopo-body {
    writing-mode: vertical-rl;
    text-orientation: upright;
    line-height: 1;
}

.target-word rt .bopo-tone {
    align-self: center;
    justify-self: center;
    line-height: 1;
}

/* Image */

.image-wrap {
    width: 100%;
    border-radius: 10px;
    overflow: hidden;
    position: relative;
    margin-bottom: 24px;
}

.image-wrap::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06),
               inset 0 2px 8px rgba(0, 0, 0, 0.25);
    pointer-events: none;
}

.image-wrap img {
    width: 100% !important;
    min-width: 100%;
    height: clamp(140px, 45vw, 220px);
    object-fit: cover;
    display: block;
}

/* Sentence-level furigana */

.sentence ruby {
    ruby-align: center;
}

.sentence rt {
    font-size: 0.5em;
    font-weight: 400;
    color: inherit;
    transform: translateY(-1px);
}

@media (hover: none) {
    .sentence rt {
        transform: translateY(8px);
    }
}

/* Sentence */

.sentence {
    font-family: 'Source Hans', var(--zh);
    font-size: 25px;
    font-weight: 400;
    line-height: 1.85;
    color: var(--text-1);
    text-align: center;
    margin: 0 0 20px;
}

.sentence mark {
    background: var(--accent-soft);
    color: var(--accent-text);
    padding: 2px 5px;
    margin: 0 -2px;
    border-radius: 3px;
    font-weight: 500;
    text-decoration: none;
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
}

/* Definition */

.def {
    font-size: 22px;
    font-weight: 400;
    line-height: 1.45;
    color: var(--text-1);
    margin: 0 0 16px;
    text-align: left;
}

/* Japanese definition — pure CSS toggle */

.jp-def-section {
    text-align: left;
}

@media (hover: none) {
    .jp-def-section {
        text-align: center;
    }
}

.jp-def-input {
    position: absolute;
    width: 0;
    height: 0;
    opacity: 0;
    pointer-events: none;
}

.jp-def-toggle {
    display: inline-flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 6px;
    padding: 6px 14px;
    font-family: var(--mono);
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text-3);
    cursor: pointer;
    transition: color 200ms ease, border-color 200ms ease, background 200ms ease;
    margin-top: 0;
    gap: 4px;
}

@media (hover: hover) {
    .jp-def-toggle:hover {
        color: var(--text-1);
        border-color: rgba(255, 255, 255, 0.10);
        background: rgba(255, 255, 255, 0.04);
    }
}

.jp-def-toggle::after {
    content: '▸';
    font-size: 10px;
    transition: transform 200ms ease;
}

.jp-def-input:checked + .jp-def-toggle::after {
    transform: rotate(90deg);
}

.jp-def-wrap {
    text-align: initial;
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    transition: grid-template-rows 400ms cubic-bezier(0.25, 0.1, 0.25, 1), opacity 300ms ease 50ms;
}

.jp-def-wrap > * {
    overflow: hidden;
    min-height: 0;
    margin: 0;
}

.jp-def-input:checked ~ .jp-def-wrap {
    grid-template-rows: 1fr;
    opacity: 1;
}

.jp-def {
    font-family: var(--zh);
    font-size: 22px;
    font-weight: 400;
    line-height: 1.85;
    color: var(--text-1);
    margin: 0;
    padding-top: 0;
}

.jp-def::before {
    content: '';
    display: block;
    height: 3px;
}

/* Bottom audio row — mobile only duplicate */

.audio-row-bottom {
    display: none;
}

@media (hover: none) {
    .audio-row-bottom {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: clamp(8px, 4vw, 20px);
        margin-top: 0;
        margin-bottom: 24px;
    }

    .audio-row-bottom .audio-item {
        gap: 6px;
    }

    .audio-row-bottom .audio-item .replay-button {
        width: 50px !important;
        height: 50px !important;
    }

    .audio-row-bottom .audio-item .replay-button svg {
        width: 50px !important;
        height: 50px !important;
    }

    .audio-row-bottom .audio-label {
        font-size: clamp(6.5px, 2.2vw, 9px);
    }
}

/* Back entrance animation — elements start hidden, JS adds .ri after content is ready */

.answer > [style*="--d"] {
    opacity: 0;
}

.ri {
    animation: reveal 0.5s var(--spring) both;
    animation-delay: calc(var(--d, 0) * 1ms);
}

@keyframes reveal {
    from {
        opacity: 0;
        transform: translateY(36px) scale(0.92);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* AnkiDroid: disable all back-side animations (WebView performance) */
.android .answer > [style*="--d"] {
    opacity: 1;
}

.android .ri {
    animation: none;
}

.android .back .audio-item.bi {
    animation: none;
}

.android .back .audio-row {
    animation: none;
}

/* AnkiDroid: plain background, opaque card, no sheen */
.android,
.android .card {
    background: var(--bg) !important;
}

.android .card-inner {
    background: var(--bg-card);
    border: none;
    box-shadow: none;
}

.android .card-inner::after {
    display: none;
}
